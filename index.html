<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Gallery Showcase</title>
<style>
  :root {
    --bg:#0e0f12;
    --panel:#151618;
    --accent:#7c5cff;
    --gap:18px;
  }
  *{box-sizing:border-box;margin:0;padding:0;}
  body{
    background:var(--bg);
    color:#fff;
    font-family:Inter,system-ui,Arial,sans-serif;
  }
  header{
    background:linear-gradient(90deg,#1b1b1b,#262626);
    text-align:center;
    padding:80px 20px;
    font-size:3em;
    font-weight:800;
  }
  .search-bar{
    display:flex;
    justify-content:center;
    align-items:center;
    gap:10px;
    margin:30px auto 10px;
  }
  .search-bar input{
    width:220px;
    padding:10px 14px;
    border-radius:8px;
    border:none;
    background:#1c1c1e;
    color:#fff;
    font-size:1em;
  }
  .search-toggle{
    background:var(--accent);
    color:#fff;
    border:none;
    padding:10px 20px;
    border-radius:10px;
    font-weight:600;
    cursor:pointer;
  }
  .search-options{
    display:none;
    justify-content:center;
    gap:10px;
    margin-bottom:30px;
  }
  .search-options.active{display:flex;}
  .search-options button{
    background:#1d1d1f;
    border:1px solid #333;
    color:#fff;
    border-radius:8px;
    padding:10px 14px;
    cursor:pointer;
  }
  .card-grid{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(200px,1fr));
    gap:var(--gap);
    padding:40px;
  }
  .card{
    position:relative;
    border-radius:14px;
    overflow:hidden;
    aspect-ratio:1/1;
    cursor:pointer;
    background:var(--panel);
    transition:transform .2s ease, box-shadow .2s ease;
  }
  .card:hover{
    transform:translateY(-5px) scale(1.02);
    box-shadow:0 8px 20px rgba(0,0,0,0.45);
  }
  .card img{
    width:100%;
    height:100%;
    object-fit:cover;
    display:block;
  }
  .counter{
    position:absolute;
    top:8px;
    right:8px;
    width:28px;
    height:28px;
    border-radius:50%;
    background:rgba(124,92,255,0.8);
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:0.9em;
    font-weight:600;
    color:#fff;
    pointer-events:none;
  }
</style>
</head>
<body>

<header>Gallery Showcase</header>

<div class="search-bar">
  <input type="text" id="searchInput" placeholder="Search by name..." />
  <button class="search-toggle" id="toggleBtn">Options</button>
</div>

<div class="search-options" id="searchOptions">
  <button data-filter="all">All</button>
  <button data-filter="nature">Nature</button>
  <button data-filter="space">Space</button>
  <button data-filter="city">City</button>
</div>

<div class="card-grid" id="cardGrid">
  <div class="card" data-name="Ocean" data-category="nature" data-iframe="ocean">
    <img src="https://picsum.photos/400?random=1" alt="">
    <div class="counter">0</div>
  </div>
  <div class="card" data-name="Forest" data-category="nature" data-iframe="forest">
    <img src="https://picsum.photos/400?random=2" alt="">
    <div class="counter">0</div>
  </div>
  <div class="card" data-name="Galaxy" data-category="space" data-iframe="galaxy">
    <img src="https://picsum.photos/400?random=3" alt="">
    <div class="counter">0</div>
  </div>
  <div class="card" data-name="City" data-category="city" data-iframe="city">
    <img src="https://picsum.photos/400?random=4" alt="">
    <div class="counter">0</div>
  </div>
</div>

<script>
const toggleBtn=document.getElementById('toggleBtn');
const searchOptions=document.getElementById('searchOptions');
const searchInput=document.getElementById('searchInput');
const cards=document.querySelectorAll('.card');

// Toggle dropdown
toggleBtn.addEventListener('click',()=>searchOptions.classList.toggle('active'));

// Filter by buttons
searchOptions.addEventListener('click',e=>{
  if(e.target.tagName!=='BUTTON')return;
  const filter=e.target.dataset.filter;
  cards.forEach(card=>{
    if(filter==='all'||card.dataset.category===filter) card.style.display='block';
    else card.style.display='none';
  });
});

// Typing filter
searchInput.addEventListener('input',()=>{
  const term=searchInput.value.toLowerCase();
  cards.forEach(card=>{
    card.style.display=card.dataset.name.toLowerCase().includes(term)?'block':'none';
  });
});

// Counter + open about:blank with viewer.html iframe
cards.forEach(card=>{
  const name=card.dataset.name;
  const iframeId=card.dataset.iframe;
  const counter=card.querySelector('.counter');
  let count=parseInt(localStorage.getItem(name))||0;
  counter.textContent=count;
  card.addEventListener('click',()=>{
    count++;
    localStorage.setItem(name,count);
    counter.textContent=count;

    // open about:blank and inject iframe to viewer.html
    const newTab=window.open('about:blank','_blank');
    newTab.document.write(`
      <!DOCTYPE html>
      <html>
      <head><title>${name}</title>
      <style>html,body{margin:0;padding:0;width:100%;height:100%;background:#0e0f12;overflow:hidden;}
      iframe{width:100%;height:100%;border:none;}</style>
      </head>
      <body>
        <iframe src="viewer.html?view=${iframeId}"></iframe>
      </body>
      </html>
    `);
    newTab.document.close();
  });
});
</script>

</body>
</html>
